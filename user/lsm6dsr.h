/*********************************************************************************************************************
 * @file        lsm6dsr.h
 * @brief       LSM6DSR 六轴 IMU 驱动 (头文件)
 * @details     适用于 LSM6DSRTR 芯片，软件 SPI 通信
 *              与 IMU660RA 可切换使用
 * @author      智能车竞赛代码
 * @version     1.0
 * @date        2026-02-10
 * 
 * @note        接线:
 *              SCK  -> P4.0
 *              MOSI -> P4.1
 *              MISO -> P4.2
 *              CS   -> P4.3
 *              VCC  -> 3.3V
 *              GND  -> GND
 ********************************************************************************************************************/

#ifndef __LSM6DSR_H__
#define __LSM6DSR_H__

#include "zf_common_headfile.h"

/*==================================================================================================================
 *                                              引脚定义
 *==================================================================================================================*/

/* 使用与 IMU660RA 相同的 SPI 引脚 */
#define LSM6DSR_SCK_PIN         P40
#define LSM6DSR_MOSI_PIN        P41
#define LSM6DSR_MISO_PIN        P42
#define LSM6DSR_CS_PIN          P43

/*==================================================================================================================
 *                                              寄存器定义
 *==================================================================================================================*/

#define LSM6DSR_WHO_AM_I        0x0F        /* 芯片 ID 寄存器, 期望值 0x6B */
#define LSM6DSR_CTRL1_XL        0x10        /* 加速度计控制寄存器 */
#define LSM6DSR_CTRL2_G         0x11        /* 陀螺仪控制寄存器 */
#define LSM6DSR_CTRL3_C         0x12        /* 控制寄存器3 (BDU, IF_INC等) */
#define LSM6DSR_CTRL4_C         0x13        /* 控制寄存器4 */
#define LSM6DSR_CTRL6_C         0x15        /* 控制寄存器6 */
#define LSM6DSR_CTRL7_G         0x16        /* 控制寄存器7 */
#define LSM6DSR_STATUS_REG      0x1E        /* 状态寄存器 */
#define LSM6DSR_OUTX_L_G        0x22        /* 陀螺仪 X 低字节 */
#define LSM6DSR_OUTX_L_A        0x28        /* 加速度计 X 低字节 */

#define LSM6DSR_CHIP_ID_VALUE   0x6B        /* LSM6DSR 芯片 ID */

/*==================================================================================================================
 *                                              数据变量 (extern)
 *==================================================================================================================*/

extern int16 lsm6dsr_gyro_x, lsm6dsr_gyro_y, lsm6dsr_gyro_z;
extern int16 lsm6dsr_acc_x, lsm6dsr_acc_y, lsm6dsr_acc_z;

/*==================================================================================================================
 *                                              函数声明
 *==================================================================================================================*/

/**
 * @brief   初始化 LSM6DSR
 * @return  0=成功, 1=失败
 */
uint8 lsm6dsr_init(void);

/**
 * @brief   获取加速度计数据
 */
void lsm6dsr_get_acc(void);

/**
 * @brief   获取陀螺仪数据
 */
void lsm6dsr_get_gyro(void);

#endif /* __LSM6DSR_H__ */
